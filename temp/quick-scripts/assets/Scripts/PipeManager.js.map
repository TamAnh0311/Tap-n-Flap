{"version":3,"sources":["PipeManager.js"],"names":["PipeGroup","require","cc","Class","extends","Component","properties","pipePrefab","Prefab","pipeMoveSpeed","pipeSpacing","onLoad","pipeList","isRunning","startSpawn","_spawnPipe","spawnInterval","Math","abs","schedule","pipeGroup","pool","hasObject","getFromPool","instantiate","getComponent","node","addChild","active","init","push","recyclePipe","pipe","removeFromParent","putInPool","getNext","shift","reset","unschedule"],"mappings":";;;;;;AAAA,IAAMA,YAAYC,QAAQ,WAAR,CAAlB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACR;AACAC,oBAAYL,GAAGM,MAFP;AAGR;AACAC,uBAAe,CAAC,GAJR;AAKR;AACAC,qBAAa;AANL,KAHP;;AAYLC,UAZK,oBAYI;AACL,aAAKC,QAAL,GAAgB,EAAhB;AACA,aAAKC,SAAL,GAAiB,KAAjB;AACH,KAfI;AAiBLC,cAjBK,wBAiBO;AACR,aAAKC,UAAL;AACA,YAAIC,gBAAgBC,KAAKC,GAAL,CAAS,KAAKR,WAAL,GAAmB,KAAKD,aAAjC,CAApB;AACA,aAAKU,QAAL,CAAc,KAAKJ,UAAnB,EAA+BC,aAA/B;AACA,aAAKH,SAAL,GAAiB,IAAjB;AACH,KAtBI;AAwBLE,cAxBK,wBAwBO;AACR,YAAIK,YAAY,IAAhB;AACA,YAAIlB,GAAGmB,IAAH,CAAQC,SAAR,CAAkBtB,SAAlB,CAAJ,EAAkC;AAC9BoB,wBAAYlB,GAAGmB,IAAH,CAAQE,WAAR,CAAoBvB,SAApB,CAAZ;AACH,SAFD,MAEO;AACHoB,wBAAYlB,GAAGsB,WAAH,CAAe,KAAKjB,UAApB,EAAgCkB,YAAhC,CAA6CzB,SAA7C,CAAZ;AACH;AACD,aAAK0B,IAAL,CAAUC,QAAV,CAAmBP,UAAUM,IAA7B;AACAN,kBAAUM,IAAV,CAAeE,MAAf,GAAwB,IAAxB;AACAR,kBAAUS,IAAV,CAAe,IAAf;AACA,aAAKjB,QAAL,CAAckB,IAAd,CAAmBV,SAAnB;AACH,KAnCI;AAqCLW,eArCK,uBAqCOC,IArCP,EAqCa;AACdA,aAAKN,IAAL,CAAUO,gBAAV;AACAD,aAAKN,IAAL,CAAUE,MAAV,GAAmB,KAAnB;AACA1B,WAAGmB,IAAH,CAAQa,SAAR,CAAkBF,IAAlB;AACH,KAzCI;;;AA2CL;;AAEAG,WA7CK,qBA6CK;AACN,eAAO,KAAKvB,QAAL,CAAcwB,KAAd,EAAP;AACH,KA/CI;AAiDLC,SAjDK,mBAiDG;AACJ,aAAKC,UAAL,CAAgB,KAAKvB,UAArB;AACA,aAAKH,QAAL,GAAgB,EAAhB;AACA,aAAKC,SAAL,GAAiB,KAAjB;AACH;AArDI,CAAT","file":"PipeManager.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["const PipeGroup = require('PipeGroup');\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        /** Tài nguyên tiền chế của nút đường ống */\n        pipePrefab: cc.Prefab,\n        /** Tốc độ di chuyển ống, đơn vị px/s */\n        pipeMoveSpeed: -300,\n        /** Khoảng cách giữa mỗi cặp ống, đơn vị px */\n        pipeSpacing: 400\n    },\n\n    onLoad() {\n        this.pipeList = [];\n        this.isRunning = false;\n    },\n\n    startSpawn(){\n        this._spawnPipe();\n        let spawnInterval = Math.abs(this.pipeSpacing / this.pipeMoveSpeed);\n        this.schedule(this._spawnPipe, spawnInterval);\n        this.isRunning = true;\n    },\n\n    _spawnPipe(){\n        let pipeGroup = null;\n        if (cc.pool.hasObject(PipeGroup)) {\n            pipeGroup = cc.pool.getFromPool(PipeGroup);\n        } else {\n            pipeGroup = cc.instantiate(this.pipePrefab).getComponent(PipeGroup);\n        }\n        this.node.addChild(pipeGroup.node);\n        pipeGroup.node.active = true;\n        pipeGroup.init(this);\n        this.pipeList.push(pipeGroup);\n    },\n\n    recyclePipe(pipe) {\n        pipe.node.removeFromParent();\n        pipe.node.active = false;\n        cc.pool.putInPool(pipe);\n    },\n\n    /** Nhận ống nước thất bại tiếp theo\n */\n    getNext() {\n        return this.pipeList.shift();\n    },\n\n    reset() {\n        this.unschedule(this._spawnPipe);\n        this.pipeList = [];\n        this.isRunning = false;\n    }\n});\n"]}